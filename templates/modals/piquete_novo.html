<div class="modal" id="modal-piquete">
    <div class="modal-content" style="width: 600px; max-width: 95%; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h3><i class="fas fa-location-dot"></i> Novo Piquete</h3>
            <button class="modal-close" onclick="fecharModalPiquete()">×</button>
        </div>
        
        <div class="form-group">
            <label><strong>Nome do Piquete *</strong></label>
            <input type="text" id="pq-nome" placeholder="Ex: Piquete 01">
        </div>
        
        <div class="form-group">
            <label><strong>Tipo de Capim *</strong></label>
            <select id="pq-capim" onchange="atualizarInfoCapim()">
                <option value="">Selecione...</option>
            </select>
            <div id="info-capim" style="display:none; background: #e3f2fd; padding: 12px; border-radius: 8px; margin-top: 8px; font-size: 0.85rem;"></div>
        </div>
        
        <div class="form-group">
            <label><strong>Área (hectares) *</strong></label>
            <input type="number" id="pq-area" value="0" step="0.1" readonly style="background: #f5f5f5;">
            <small style="color: #666;"><i class="fas fa-lightbulb"></i> Área calculada automaticamente pelo mapa. Se não desenhar, libere o campo.</small>
        </div>
        
        <!-- Parâmetros Técnicos Obrigatórios -->
        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <h4 style="margin-bottom: 12px; color: #856404;"><i class="fas fa-gear"></i> Parâmetros Técnicos (Obrigatórios)</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div class="form-group">
                    <label>Altura de Entrada (cm) *</label>
                    <input type="number" id="pq-altura-entrada" value="0" min="1" step="1">
                </div>
                <div class="form-group">
                    <label>Altura Mínima de Saída (cm) *</label>
                    <input type="number" id="pq-altura-saida" value="0" min="1" step="1">
                </div>
            </div>
        </div>
        
        <!-- Parâmetros Avançados -->
        <details style="margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px;">
            <summary style="padding: 12px; cursor: pointer; background: #f8f9fa; border-radius: 8px; font-weight: bold;">
                <i class="fas fa-wrench"></i> Parâmetros Avançados (Opcionais)
            </summary>
            <div style="padding: 15px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                    <div class="form-group">
                        <label>Altura Atual do Pasto (cm)</label>
                        <input type="number" id="pq-altura-atual" value="" min="0" step="1" placeholder="Opcional">
                    </div>
                    <div class="form-group">
                        <label>Data da Medição</label>
                        <input type="date" id="pq-data-medicao">
                    </div>
                    <div class="form-group">
                        <label>É Irrigado?</label>
                        <select id="pq-irrigado">
                            <option value="nao">Não</option>
                            <option value="sim">Sim</option>
                        </select>
                    </div>
                </div>
                
                <!-- Suplementação (ração via cocho) -->
                <div style="background: #e8f5e9; padding: 12px; border-radius: 8px; margin-top: 12px;">
                    <div class="form-group" style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="pq-possui-cocho" onchange="alternarSuplementacao()" style="width: 18px; height: 18px;">
                            <strong><i class="fas fa-drumstick-bite"></i> Possui cocho de suplementação?</strong>
                            <button type="button" onclick="abrirModalAjudaCocho()" style="background: none; border: none; color: #007bff; cursor: pointer; font-size: 1rem; padding: 0 5px;" title="Ajuda sobre cocho"><i class="fas fa-circle-question"></i></button>
                        </label>
                    </div>
                    <div id="div-percentual-suplementacao" class="form-group" style="display: none; margin-bottom: 0;">
                        <label>Percentual da dieta via ração (%)</label>
                        <input type="number" id="pq-percentual-suplementacao" min="1" max="70" step="1" value="0" placeholder="1-70%">
                        <small style="color: #666;">Reduce o consumo de pasto proporcionalmente (máx. 70%)</small>
                    </div>
                </div>
                <div class="form-group">
                    <label>Observações Técnicas</label>
                    <textarea id="pq-observacoes" rows="2" placeholder="Solo, histórico, etc." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"></textarea>
                </div>
            </div>
        </details>
        
        <p style="color: #666; font-size: 0.85rem; margin-bottom: 15px;">
            <i class="fas fa-lightbulb"></i> Desenhe o contorno do piquete no mapa abaixo:
        </p>
        
        <button class="btn btn-primary" style="margin-bottom: 10px;" onclick="centralizarLocalizacao()"><i class="fas fa-location-dot"></i> Minha Localização</button>
        <button class="btn" style="margin-bottom: 10px; background:#6c757d;color:white;margin-left:5px;" onclick="liberarAreaManual()"><i class="fas fa-pen"></i> Liberar Área</button>
        <button class="btn btn-warning" style="margin-bottom: 10px; margin-left:5px;" onclick="desfazerPonto()"><i class="fas fa-rotate-left"></i> Desfazer</button>
        <button class="btn btn-danger" style="margin-bottom: 10px; margin-left:5px;" onclick="limparDesenho()"><i class="fas fa-trash"></i> Limpar</button>
        <div id="map-desenho" style="height: 250px; border-radius: 8px; margin-bottom: 15px; cursor: crosshair; border: 2px dashed #00d9ff;"></div>
        
        <button class="btn btn-success" style="width: 100%; padding: 12px; font-size: 1rem;" onclick="validarSalvarPiquete()"><i class="fas fa-save"></i> Salvar Piquete</button>
    </div>
</div>

<!-- Modal para parâmetros de capim personalizado (Outro) -->
<div class="modal" id="modal-capim-outro">
    <div class="modal-content" style="width: 420px; max-width: 95%;">
        <div class="modal-header">
            <h3><i class="fas fa-leaf"></i> Configurar capim personalizado</h3>
            <button class="modal-close" onclick="fecharModalCapimOutro()">×</button>
        </div>
        <div class="form-group">
            <label><strong>Crescimento (cm/dia) *</strong></label>
            <input type="number" id="outro-crescimento" min="0.1" step="0.1" placeholder="Ex: 1.4">
        </div>
        <div class="form-group">
            <label><strong>Fator consumo *</strong></label>
            <input type="number" id="outro-fator-consumo" min="0.1" step="0.01" placeholder="Ex: 0.85">
        </div>
        <div class="form-group">
            <label><strong>Lotação sugerida (UA/ha) *</strong></label>
            <input type="number" id="outro-lotacao" min="0.1" step="0.1" placeholder="Ex: 3.0">
        </div>
        <div style="display: flex; gap: 8px; justify-content: flex-end; margin-top: 12px;">
            <button class="btn btn-secondary" onclick="fecharModalCapimOutro()">Cancelar</button>
            <button class="btn btn-primary" onclick="salvarCapimOutroCustom()">Salvar</button>
        </div>
    </div>
</div>

<!-- Modal de Ajuda - Suplementação via Cocho -->
<div class="modal" id="modal-ajuda-cocho">
    <div class="modal-content" style="width: 500px; max-width: 95%; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h3><i class="fas fa-circle-question"></i> Como preencher o percentual do cocho?</h3>
            <button class="modal-close" onclick="fecharModalAjudaCocho()">×</button>
        </div>
        <div style="padding: 15px; font-size: 0.9rem; line-height: 1.6;">
            <p style="margin-bottom: 15px;">Esse campo indica quanto da alimentação dos animais vem da ração/suplemento do cocho, e não do pasto. O valor deve ser informado em percentual (%).</p>
            
            <p style="margin-bottom: 15px;"><strong><i class="fas fa-lightbulb"></i> Como pensar nisso?</strong><br>
            Imagine que o animal come 100% da alimentação diária. Se parte disso vem do cocho, você informa aqui essa parte.</p>
            
            <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-bottom: 15px;">
                <strong><i class="fas fa-flask"></i> Exemplos práticos:</strong>
                <ul style="margin: 8px 0 0 0; padding-left: 20px;">
                    <li>Sal mineral puro → <strong>2% a 3%</strong></li>
                    <li>Sal mineral com ureia → <strong>até 5%</strong></li>
                    <li>Proteico seco → <strong>10% a 15%</strong></li>
                    <li>Proteico-energético → <strong>20% a 30%</strong></li>
                </ul>
            </div>
            
            <p style="margin-bottom: 15px;"><strong><i class="fas fa-cow"></i> Exemplo simples:</strong></p>
            <ul style="margin-bottom: 15px; padding-left: 20px;">
                <li>Se os animais consomem apenas sal mineral comum: ➡️ Preencha com <strong>3%</strong></li>
                <li>Se estiver fornecendo ração proteica mais forte: ➡️ Pode usar <strong>10%</strong> ou mais</li>
            </ul>
            
            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 4px solid #ffc107;">
                <strong><i class="fas fa-triangle-exclamation"></i> Atenção</strong><br>
                Se não houver cocho no piquete, deixe como 0%. Esse valor reduz automaticamente a estimativa de consumo de pasto. Não é necessário cálculo exato — use uma estimativa baseada no tipo de suplemento.
            </div>
        </div>
        <button class="btn btn-primary" style="width: 100%;" onclick="fecharModalAjudaCocho()">Entendi</button>
    </div>
</div>

<script>
function abrirModalAjudaCocho() {
    document.getElementById('modal-ajuda-cocho').classList.add('active');
}
function fecharModalAjudaCocho() {
    document.getElementById('modal-ajuda-cocho').classList.remove('active');
}
</script>
