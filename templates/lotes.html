<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lotes - PastoFlow</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="icon" type="image/x-icon" href="/static/icon/PastoFlow-logo.ico">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/lotes.css') }}">
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div>
            <h1>ğŸ„ Lotes</h1>
            <p style="opacity: 0.8; font-size: 0.9rem;">{{ fazenda.nome }}</p>
        </div>
        <a href="/fazenda/{{ fazenda.id }}">â† Voltar</a>
    </div>
    
    <div class="content">
        <!-- Stats -->
        <div class="stats-row">
            <div class="stat-card animais">
                <strong id="stat-total">0</strong>
                <span>ğŸ„ Total de Lotes</span>
            </div>
            <div class="stat-card ocupacao">
                <strong id="stat-ocupacao">0</strong>
                <span>ğŸ“ Em OcupaÃ§Ã£o</span>
            </div>
            <div class="stat-card saida">
                <strong id="stat-saida">0</strong>
                <span>âš ï¸ Precisa Sair</span>
            </div>
            <div class="stat-card disponivel">
                <strong id="stat-animais">0</strong>
                <span>ğŸƒ Total Animais</span>
            </div>
        </div>
        
        <!-- Filters -->
        <div class="filters">
            <label>Status:</label>
            <select id="filtro-status" onchange="carregarLotes()">
                <option value="">Todos</option>
                <option value="OK">ğŸŸ¢ OK</option>
                <option value="ATENCAO">ğŸŸ  AtenÃ§Ã£o</option>
                <option value="RETIRAR">ğŸ”´ Retirar</option>
                <option value="AGUARDANDO_ALOCACAO">ğŸ”µ Aguardando AlocaÃ§Ã£o</option>
            </select>
            
            <label>Categoria:</label>
            <select id="filtro-categoria" onchange="carregarLotes()">
                <option value="">Todas</option>
                <option value="Bezerro(a)">Bezerro(a)</option>
                <option value="Garrote / Novilho(a)">Garrote / Novilho(a)</option>
                <option value="Boi Magro / Engorda">Boi Magro / Engorda</option>
                <option value="Vaca">Vaca</option>
                <option value="Touro">Touro</option>
            </select>
            
            <button class="btn btn-warning" onclick="atualizarStatus()">ğŸ”„ Atualizar Status</button>
            <button class="btn btn-primary" onclick="abrirModalNovoLote()">â• Novo Lote</button>
        </div>
        
        <!-- Tabela -->
        <div class="table-container">
            <div class="table-header">
                <h2>ğŸ“‹ Lotes Ativos</h2>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>ğŸ‚ Lote</th>
                        <th>ğŸ“ Piquete Atual</th>
                        <th>â±ï¸ Dias TÃ©cnicos</th>
                        <th>ğŸ“Š Status</th>
                        <th>ğŸ“‹ PrÃ³ximos</th>
                        <th>âš™ï¸ AÃ§Ãµes</th>
                    </tr>
                </thead>
                <tbody id="lista-lotes">
                    <tr>
                        <td colspan="6" class="empty-state">
                            <h3>Carregando...</h3>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Modais -->
    {% include 'modals/lote_personalizado.html' %}
    {% include 'modals/lote_novo.html' %}
    {% include 'modals/lote_editar.html' %}
    {% include 'modals/lote_mover.html' %}
    {% include 'modals/lote_todos_piquetes.html' %}
    {% include 'modals/lote_detalhes.html' %}
    
    <script>
        const fazendaId = {{ fazenda.id }};
        let lotes = [];
        let dataTeste = null;
    </script>
    <script src="{{ url_for('static', filename='js/lotes.js') }}"></script>
</body>
</html>